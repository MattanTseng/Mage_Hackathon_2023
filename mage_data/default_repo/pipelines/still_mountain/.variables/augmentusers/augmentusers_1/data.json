"{\"data\": [\"\\u001b[0;31m---------------------------------------------------------------------------\\u001b[0m\", \"\\u001b[0;31mNameError\\u001b[0m                                 Traceback (most recent call last)\", \"File \\u001b[0;32m<string>:9\\u001b[0m\\n\", \"\\u001b[0;31mNameError\\u001b[0m: name 'user' is not defined\"], \"error\": [\"\\u001b[0;31m---------------------------------------------------------------------------\\u001b[0m\", \"\\u001b[0;31mNameError\\u001b[0m                                 Traceback (most recent call last)\", \"Cell \\u001b[0;32mIn[29], line 98\\u001b[0m\\n\\u001b[1;32m     95\\u001b[0m     \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m     96\\u001b[0m         \\u001b[38;5;28;01mreturn\\u001b[39;00m find(\\u001b[38;5;28;01mlambda\\u001b[39;00m val: val \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m, output)\\n\\u001b[0;32m---> 98\\u001b[0m df \\u001b[38;5;241m=\\u001b[39m \\u001b[43mexecute_custom_code\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    100\\u001b[0m \\u001b[38;5;66;03m# Post processing code below (source: output_display.py)\\u001b[39;00m\\n\\u001b[1;32m    103\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21m__custom_output\\u001b[39m():\\n\", \"Cell \\u001b[0;32mIn[29], line 76\\u001b[0m, in \\u001b[0;36mexecute_custom_code\\u001b[0;34m()\\u001b[0m\\n\\u001b[1;32m     73\\u001b[0m \\u001b[38;5;28;01mexcept\\u001b[39;00m \\u001b[38;5;167;01mException\\u001b[39;00m:\\n\\u001b[1;32m     74\\u001b[0m     \\u001b[38;5;28;01mpass\\u001b[39;00m\\n\\u001b[0;32m---> 76\\u001b[0m block_output \\u001b[38;5;241m=\\u001b[39m \\u001b[43mblock\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_with_callback\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m     77\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcode\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     78\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     79\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43manalyze_outputs\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mFalse\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     80\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mrun_settings\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mjson\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mloads\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[38;5;124;43m'\\u001b[39;49m\\u001b[38;5;132;43;01m{}\\u001b[39;49;00m\\u001b[38;5;124;43m'\\u001b[39;49m\\u001b[43m)\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     81\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mupdate_status\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mTrue\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     82\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mTrue\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     83\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m     84\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28;01mTrue\\u001b[39;00m:\\n\\u001b[1;32m     85\\u001b[0m     block\\u001b[38;5;241m.\\u001b[39mrun_tests(\\n\\u001b[1;32m     86\\u001b[0m         custom_code\\u001b[38;5;241m=\\u001b[39mcode,\\n\\u001b[1;32m     87\\u001b[0m         global_vars\\u001b[38;5;241m=\\u001b[39mglobal_vars,\\n\\u001b[1;32m     88\\u001b[0m         from_notebook\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mTrue\\u001b[39;00m,\\n\\u001b[1;32m     89\\u001b[0m         update_tests\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mFalse\\u001b[39;00m,\\n\\u001b[1;32m     90\\u001b[0m     )\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:625\\u001b[0m, in \\u001b[0;36mBlock.execute_with_callback\\u001b[0;34m(self, global_vars, logger, logging_tags, **kwargs)\\u001b[0m\\n\\u001b[1;32m    618\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mcallback_block:\\n\\u001b[1;32m    619\\u001b[0m         \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mcallback_block\\u001b[38;5;241m.\\u001b[39mexecute_callback(\\n\\u001b[1;32m    620\\u001b[0m             \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mon_failure\\u001b[39m\\u001b[38;5;124m'\\u001b[39m,\\n\\u001b[1;32m    621\\u001b[0m             global_vars\\u001b[38;5;241m=\\u001b[39mglobal_vars,\\n\\u001b[1;32m    622\\u001b[0m             logger\\u001b[38;5;241m=\\u001b[39mlogger,\\n\\u001b[1;32m    623\\u001b[0m             logging_tags\\u001b[38;5;241m=\\u001b[39mlogging_tags,\\n\\u001b[1;32m    624\\u001b[0m         )\\n\\u001b[0;32m--> 625\\u001b[0m     \\u001b[38;5;28;01mraise\\u001b[39;00m e\\n\\u001b[1;32m    627\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mcallback_block:\\n\\u001b[1;32m    628\\u001b[0m     \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mcallback_block\\u001b[38;5;241m.\\u001b[39mexecute_callback(\\n\\u001b[1;32m    629\\u001b[0m         \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mon_success\\u001b[39m\\u001b[38;5;124m'\\u001b[39m,\\n\\u001b[1;32m    630\\u001b[0m         global_vars\\u001b[38;5;241m=\\u001b[39mglobal_vars,\\n\\u001b[1;32m    631\\u001b[0m         logger\\u001b[38;5;241m=\\u001b[39mlogger,\\n\\u001b[1;32m    632\\u001b[0m         logging_tags\\u001b[38;5;241m=\\u001b[39mlogging_tags,\\n\\u001b[1;32m    633\\u001b[0m     )\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:611\\u001b[0m, in \\u001b[0;36mBlock.execute_with_callback\\u001b[0;34m(self, global_vars, logger, logging_tags, **kwargs)\\u001b[0m\\n\\u001b[1;32m    604\\u001b[0m \\u001b[38;5;250m\\u001b[39m\\u001b[38;5;124;03m\\\"\\\"\\\"\\u001b[39;00m\\n\\u001b[1;32m    605\\u001b[0m \\u001b[38;5;124;03mThis method will execute the block and run the callback functions if they exist\\u001b[39;00m\\n\\u001b[1;32m    606\\u001b[0m \\u001b[38;5;124;03mfor this block. This function should only be used when running a block from the\\u001b[39;00m\\n\\u001b[1;32m    607\\u001b[0m \\u001b[38;5;124;03mwebsocket as a way to test the code in the callback. To run a block in a pipeline\\u001b[39;00m\\n\\u001b[1;32m    608\\u001b[0m \\u001b[38;5;124;03mrun, use a BlockExecutor.\\u001b[39;00m\\n\\u001b[1;32m    609\\u001b[0m \\u001b[38;5;124;03m\\\"\\\"\\\"\\u001b[39;00m\\n\\u001b[1;32m    610\\u001b[0m \\u001b[38;5;28;01mtry\\u001b[39;00m:\\n\\u001b[0;32m--> 611\\u001b[0m     output \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_sync\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    612\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    613\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogger\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogger\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    614\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    615\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[38;5;241;43m*\\u001b[39;49m\\u001b[38;5;241;43m*\\u001b[39;49m\\u001b[43mkwargs\\u001b[49m\\n\\u001b[1;32m    616\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    617\\u001b[0m \\u001b[38;5;28;01mexcept\\u001b[39;00m \\u001b[38;5;167;01mException\\u001b[39;00m \\u001b[38;5;28;01mas\\u001b[39;00m e:\\n\\u001b[1;32m    618\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mcallback_block:\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:743\\u001b[0m, in \\u001b[0;36mBlock.execute_sync\\u001b[0;34m(self, analyze_outputs, build_block_output_stdout, custom_code, execution_partition, global_vars, logger, logging_tags, run_all_blocks, test_execution, update_status, store_variables, verify_output, input_from_output, runtime_arguments, dynamic_block_index, dynamic_block_uuid, dynamic_upstream_block_uuids, run_settings)\\u001b[0m\\n\\u001b[1;32m    734\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m logger \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[1;32m    735\\u001b[0m         logger\\u001b[38;5;241m.\\u001b[39mexception(\\n\\u001b[1;32m    736\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mFailed to execute block \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00m\\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39muuid\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m,\\n\\u001b[1;32m    737\\u001b[0m             \\u001b[38;5;241m*\\u001b[39m\\u001b[38;5;241m*\\u001b[39mmerge_dict(logging_tags, \\u001b[38;5;28mdict\\u001b[39m(\\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m    741\\u001b[0m             ))\\n\\u001b[1;32m    742\\u001b[0m         )\\n\\u001b[0;32m--> 743\\u001b[0m     \\u001b[38;5;28;01mraise\\u001b[39;00m err\\n\\u001b[1;32m    744\\u001b[0m \\u001b[38;5;28;01mfinally\\u001b[39;00m:\\n\\u001b[1;32m    745\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m update_status:\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:674\\u001b[0m, in \\u001b[0;36mBlock.execute_sync\\u001b[0;34m(self, analyze_outputs, build_block_output_stdout, custom_code, execution_partition, global_vars, logger, logging_tags, run_all_blocks, test_execution, update_status, store_variables, verify_output, input_from_output, runtime_arguments, dynamic_block_index, dynamic_block_uuid, dynamic_upstream_block_uuids, run_settings)\\u001b[0m\\n\\u001b[1;32m    667\\u001b[0m         \\u001b[38;5;28;01mraise\\u001b[39;00m \\u001b[38;5;167;01mException\\u001b[39;00m(\\n\\u001b[1;32m    668\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\u001b[38;5;124mBlock \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00m\\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39muuid\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124ms upstream blocks have not been executed yet. \\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\n\\u001b[1;32m    669\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mPlease run upstream blocks \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00mupstream_block_uuids\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m \\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    670\\u001b[0m             \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mbefore running the current block.\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    671\\u001b[0m         )\\n\\u001b[1;32m    672\\u001b[0m global_vars \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m__enrich_global_vars(global_vars)\\n\\u001b[0;32m--> 674\\u001b[0m output \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_block\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    675\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mbuild_block_output_stdout\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mbuild_block_output_stdout\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    676\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    677\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    678\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    679\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mlogger\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogger\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    680\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    681\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mtest_execution\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    682\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43minput_from_output\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_from_output\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    683\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    684\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mdynamic_block_index\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mdynamic_block_index\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    685\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mdynamic_upstream_block_uuids\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mdynamic_upstream_block_uuids\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    686\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mrun_settings\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mrun_settings\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    687\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    688\\u001b[0m block_output \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mpost_process_output(output)\\n\\u001b[1;32m    689\\u001b[0m variable_mapping \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m()\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:911\\u001b[0m, in \\u001b[0;36mBlock.execute_block\\u001b[0;34m(self, build_block_output_stdout, custom_code, execution_partition, input_args, logger, logging_tags, global_vars, test_execution, input_from_output, runtime_arguments, dynamic_block_index, dynamic_upstream_block_uuids, run_settings)\\u001b[0m\\n\\u001b[1;32m    908\\u001b[0m     \\u001b[38;5;28;01mfor\\u001b[39;00m kwargs_var \\u001b[38;5;129;01min\\u001b[39;00m kwargs_vars:\\n\\u001b[1;32m    909\\u001b[0m         global_vars_copy\\u001b[38;5;241m.\\u001b[39mupdate(kwargs_var)\\n\\u001b[0;32m--> 911\\u001b[0m     outputs \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_execute_block\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    912\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43moutputs_from_input_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    913\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    914\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    915\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43minput_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    916\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogger\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogger\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    917\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    918\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars_copy\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    919\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mtest_execution\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    920\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43minput_from_output\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_from_output\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    921\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    922\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mupstream_block_uuids\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mupstream_block_uuids\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    923\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mrun_settings\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mrun_settings\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    924\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    926\\u001b[0m output_message \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m(output\\u001b[38;5;241m=\\u001b[39moutputs)\\n\\u001b[1;32m    928\\u001b[0m \\u001b[38;5;28;01mreturn\\u001b[39;00m output_message\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:956\\u001b[0m, in \\u001b[0;36mBlock._execute_block\\u001b[0;34m(self, outputs_from_input_vars, custom_code, execution_partition, input_vars, logger, logging_tags, global_vars, test_execution, input_from_output, runtime_arguments, upstream_block_uuids, run_settings)\\u001b[0m\\n\\u001b[1;32m    954\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m custom_code \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[1;32m    955\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m BlockType\\u001b[38;5;241m.\\u001b[39mCHART \\u001b[38;5;241m!=\\u001b[39m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mtype \\u001b[38;5;129;01mor\\u001b[39;00m (\\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mgroup_by_columns \\u001b[38;5;129;01mor\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mmetrics):\\n\\u001b[0;32m--> 956\\u001b[0m         \\u001b[43mexec\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mresults\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    957\\u001b[0m \\u001b[38;5;28;01melif\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mcontent \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[1;32m    958\\u001b[0m     exec(\\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mcontent, results)\\n\", \"File \\u001b[0;32m<string>:9\\u001b[0m\\n\", \"\\u001b[0;31mNameError\\u001b[0m: name 'user' is not defined\"], \"execution_state\": null, \"metadata\": null, \"msg_id\": \"72f3d472-9c898e8202f58571b73798f8_11_30\", \"msg_type\": \"error\", \"type\": \"text\", \"block_type\": \"transformer\", \"pipeline_uuid\": null, \"uuid\": \"augmentusers\"}"